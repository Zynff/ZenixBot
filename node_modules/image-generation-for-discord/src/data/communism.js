const request = require("node-superfetch")
const Canvas = require('canvas')
let { loadImage } = require("canvas")

async function communism(baseAvatarURL) {
    if (!baseAvatarURL) throw new Error(`Please provide a valid image url.`)

    const overlayAvatarURL = "https://miro.medium.com/max/1200/1*L_uBUcOn1-NvGPQFZ4XlrQ.png"

    const baseAvatarData = await request.get(baseAvatarURL);
    const baseAvatar = await loadImage(baseAvatarData.body);
    const overlayAvatarData = await request.get(overlayAvatarURL);
    const overlayAvatar = await loadImage(overlayAvatarData.body);
    const canvas = Canvas.createCanvas(baseAvatar.width, baseAvatar.height);
    const ctx = canvas.getContext('2d');
    ctx.globalAlpha = 0.3;
    ctx.drawImage(baseAvatar, 0, 0);
    ctx.drawImage(overlayAvatar, 0, 0, baseAvatar.width, baseAvatar.height);
    return canvas.toBuffer()
}
module.exports = communism