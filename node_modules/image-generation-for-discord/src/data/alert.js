const { createCanvas, registerFont, loadImage } = require('canvas')
const path = require('path');
const { wrapText } = require('../functions/canvas')
registerFont(path.join(__dirname, '..', 'assets', 'fonts', 'SF-Pro-Display-Medium.otf'), { family: 'SF Pro' })

async function alert(text) {

    if (!text) throw new Error(`Please provide a alert message.`)

    const base = await loadImage(`https://raw.githubusercontent.com/caseyCantCode/discordImageGenImages/main/presidential_alert.png`)
    const canvas = createCanvas(base.width, base.height)
    const ctx = canvas.getContext('2d')

    ctx.drawImage(base, 0, 0)
    ctx.font = "30px SF Pro"
    ctx.fillStyle = "#1f1f1f"
    ctx.textBaseline = "top"
    let text1 = await wrapText(ctx, text, 540)
    text1 = text.length > 3 ? `${text.slice(0, 3).join("\n")}...` : text.join("\n")
    ctx.fillText(text, 60, 830)
    return canvas.toBuffer()
}
module.exports = alert