const { createCanvas, loadImage } = require('canvas');
const { wrapText } = require('../functions/canvas');

async function twobuttons(first, second) {
    if (!first || !second) throw new Error(`Please provide a first text and a second text.`)

    const base = await loadImage(`https://raw.githubusercontent.com/caseyCantCode/discordImageGenImages/main/two-buttons.png`);
    const canvas = createCanvas(base.width, base.height);
    const ctx = canvas.getContext('2d');
    ctx.textBaseline = 'top';
    ctx.drawImage(base, 0, 0);
    ctx.rotate(-12 * (Math.PI / 180));
    ctx.font = `34px Arial`
    let fontSize = 34;
    while (ctx.measureText(first).width > 366) {
        fontSize--;
        ctx.font = `${fontSize}px Arial`
    }
    const firstLines = await wrapText(ctx, first, 183);
    let lineOffset = 0;
    for (let i = 0; i < firstLines.length; i++) {
        ctx.fillText(firstLines[i], 25 + lineOffset, 116 + (fontSize * i) + (10 * i), 183);
        lineOffset += 5;
    }
    ctx.font = `34px Arial`
    fontSize = 34;
    while (ctx.measureText(second).width > 244) {
        fontSize--;
        ctx.font = `${fontSize}px Arial`
    }
    const secondLines = await wrapText(ctx, second, 118);
    lineOffset = 0;
    for (let i = 0; i < secondLines.length; i++) {
        ctx.fillText(secondLines[i], 254 + lineOffset, 130 + (fontSize * i) + (10 * i), 118);
        lineOffset += 5;
    }
    ctx.rotate(12 * (Math.PI / 180));
    return canvas.toBuffer()
}
module.exports = twobuttons